language: python
branches:
  only:
    - master
python:
  - "2.7"
services:
  - postgresql
env: 
  global:
    - SITE_NAME='Test Site'
    - META_KEYWORDS='test'
    - META_DESCRIPTION='Test'
    - BREWER_NAME='Brewer Name'
    - BREWER_EMAIL='brewer@example.org'
    - BREWER_LOCATION='Somewhere, US'
    - SITE_ID=1
    - SECRET_KEY='*n4-$m9(fkr!ghro4=tz!%=0mkv5=90mi%8d$!p^ir@3mm@=zv'
    - PUBLIC_ROOT=/tmp/public
    - EMAIL_URL=smtps://pyment@example.org:sip99a@smtp.example.org:587
    - EMAIL_SUBJECT_PREFIX='[Pyment Dev] '
    - USE_X_FORWARDED_HOST=False
    - ALLOWED_HOSTS=localhost,127.0.0.1
before_script:
  - psql -c 'create database travis_ci_db;' -U postgres
  - touch pyment/.env
  - mkdir -p /tmp/public
  - python manage.py collectstatic --noinput
  - python manage.py syncdb --noinput
  - pip install coveralls
script:
  - coverage run --source=. manage.py test